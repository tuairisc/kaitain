"use strict"
jQuery(function(e){function a(e){return e=e.replace(/\s/,"").replace(/\s.*/,"").replace(/"/g,""),e=e.charAt(0).toLowerCase()+e.substr(1),e=e.replace("#","id").replace('"',"")}function t(a,t){var n="{ "
return t=t.sanitize().split('","'),e.each(t,function(e,a){t[e]=a.replace('"',""),t[e]="00:00"===t[e]?"":t[e]}),e.each(a,function(e,r){n+='"'+r+'":',n+='"'+t[e]+'"',e<a.length-1&&(n+=",")}),n+=" }",JSON.parse(n)}function n(e){var a=""
switch(e.toLowerCase()){case"gaillimh":case"liatroim":case"maigh eo":case"ros comáin":case"sligeach":a=o[0]
break
case"an clár":case"corcaigh":case"ciarraí":case"luimneach":case"tiobraid árainn":case"port láirge":a=o[1]
break
case"aontroim":case"ard mhacha":case"an cabhán":case"dún na ngall":case"an dún":case"fear manach":case"doire":case"muineachán":case"tír eoghain":a=o[2]
break
case"ceatharlach":case"áth cliath":case"cill dara":case"cill chainnigh":case"laois":case"longfort":case"lú":case"an mhí":case"uibh fhailí":case"an iarmhí":case"loch garman":case"cill mhantáin":a=o[3]}return a}function r(a,t){for(var n=0;n<a.length;n++)i.add('<div class="province">',"",!1),i.add("<h1>",a[n]),e.each(t,function(t,r){r.province===a[n]&&(i.add('<div class="event">',"",!1),e.each(r,function(e,a){a&&i.elements[e]&&(i.add(i.elements[e].tag,i.elements[e].contentBefore+a),i.elements[e].breakAfter&&i.add("<br />","",!1))}),i.add("</div>","",!1))}),i.add("</div>","",!1)}function c(c){var l=new FileReader
e("textarea").first().val(""),l.onload=function(c){i.value=""
var l=c.target.result.split(/"\n/),u=[],p=[]
e.each(l[0].split(","),function(e,t){u.push(a(t))}),e.each(l,function(e,a){e>0&&a&&p.push(t(u,a))}),e.each(p,function(e,a){p[e].province=n(a.county)}),r(o,p),e(s.output).val(i.getHtml())},l.onerror=function(a){e(s.output).val(a),console.error(a)},l.readAsText(c[0])}var s={input:".event-drop",drag:"file-drag",output:"textarea[class=event-output]"},o=["Connachta","Laighin","Mumhain","Ulaidh"]
String.prototype.sanitize=function(){return this.replace(/\r?\n|\r/g,"").replace(/<(?:.|\n)*?>/gm,"")}
var i={result:[],add:function(e,a,t){var n=""
a=a||"",t=t!==!1?!0:t,n+=e,n+=a,t&&(n+=e.replace(/^.*</,"</").replace(/>.*$/,">").replace(/\sclass=".*?"/,"")),this.result.push(n)},getHtml:function(){return this.result.join("")},elements:{eventType:{tag:'<span class="type">',contentBefore:"Catagóir: ",breakAfter:!0},eventTitle:{tag:"<h4>",contentBefore:"",useBreak:!1},entryFee:{tag:'<span class="fee">',contentBefore:"Táille iontrála: €",breakAfter:!0},contactName:{tag:'<span class="contact-name">',contentBefore:"Teagmháil: ",breakAfter:!1},contactInformation:{tag:'<span class="contact-info">',contentBefore:"",breakAfter:!0},location:{tag:'<span class="location">',contentBefore:"Suíomh: ",breakAfter:!1},county:{tag:'<span class="county">',contentBefore:", Co. ",breakAfter:!0},eventDescription:{tag:'<p class="description">',contentBefore:"",breakAfter:!1},startDate:{tag:'<span class="start-date">',contentBefore:"Datá: ",breakAfter:!1},time:{tag:'<span class="time">',contentBefore:" @ ",breakAfter:!0},endDate:{tag:'<span class="end-date>',contentBefore:"Dáta deiridh: ",breakAfter:!0}}}
window.File&&window.FileList&&window.FileReader&&s.input.length>0?(e(s.input).on("dragover",function(a){a.stopPropagation(),a.preventDefault(),e(this).addClass(s.drag)}),e(s.input).on("dragleave",function(a){a.stopPropagation(),a.preventDefault(),e(this).removeClass(s.drag)}),e(s.input).on("drop",function(a){return a.stopPropagation(),a.preventDefault(),e(this).removeClass(s.drag),"text/csv"!==a.originalEvent.dataTransfer.files[0].type?!1:void c(a.originalEvent.dataTransfer.files)})):(e(s.input).remove(),e(s.output).remove())})
