/**
 * Article Styling 
 * -----------------------------------------------------------------------------
 * @category   Stylesheet
 * @package    Tuairisc.ie Theme
 * @author     Mark Grealish <mark@bhalash.com>
 * @copyright  Copyright (c) 2014-2015, Tuairisc Bheo Teo
 * @license    All rights reserved
 * @version    2.0
 * @link       https://github.com/bhalash/tuairisc.ie
 * 
 * Styles for articles and their child elements. WPZOOM is pretty disorganized 
 * when it comes to posts. <article>, <div class="entry"> and <div class="post">
 * are all used interchangably in different sections of the site. 
 *
 * WPZOOM is infected with divitis and classitis. Because the CSS is under a
 * proprietary license, I go to a good deal of effort here to reset the single
 * article style before I go on to add my own.
 * 
 * Several different article templates were in use around the site. I reduced
 * their number to six:
 * 
 * 1. article.full - ordinary full-sized article for single and page posts.
 * 2. article.archive - archive loop side-by-side post.
 * 3. article.leadarchive - the first archive post. Bigger and with sides reversed.
 * 4. article.lead - the lead article on the Tuairisc homepage.
 * 5. article.featured - secondary articles on the Tuairisc homepage. 
 * 6. article.jobarchive - job archive index post.
 */

// Archive width.
$archive-width-25: 25%;
$archive-width-35: 35%;
$archive-width-65: 65%;
$archive-width-75: 75%;
// Archive thumbnail heights.
$archive-article-thumb-height-170: 170px;
$archive-article-thumb-height-325: 325px;

/**
 * Article Text Defaults
 * -----------------------------------------------------------------------------
 */

article {
    a {
        color: palette(green);
    }
}

.title a:hover {
    color: palette(green);
}

/**
 * Blockquote and Cite
 * -----------------------------------------------------------------------------
 */
 
blockquote {
    // Ciaran asked for a meticulously-styled blockquote area.
    background-image: url($blockquote-open), url($blockquote-close);
    background-position: -4% 4%, 104% 88%;
    background-origin: content-box;
    background-repeat: no-repeat;
    background-size: auto 25px;
    border-color: 1px solid color(white, light);
    border-width: 1px 0;
    font-style: italic;
    @include font-size(1.4);
    @include padding(1 2);

    >:last-child {
        margin-bottom: 0;
    }
}

cite {
    color: palette(black, mid-light);
    display: block;
    font-style: none;
    font-weight: bold;
    width: 100%;
    @include font-size(1.4);

    &:before {
        content: ' -';
    }
}

/**
 * Article Header
 * -----------------------------------------------------------------------------
 */

header {
    .title, div.excerpt {
        @include margin(0.5, bottom);
    }

    div.excerpt {
        .more-link a {
            /* Remove 'read more' link from excerpt/description. */
            display: none;
        }

        p {
            color: palette(white, mid-light);
            margin: 0;
        }
    }

    span, .article-author {
        text-transform: none;
    } 

    .article-author {
        font-weight: bold;
    }
}

/**
 * WordPress Image Captions
 * -----------------------------------------------------------------------------
 */

.wp-caption img {
    @include margin(0.75, bottom);
}

p.wp-caption-text {
    color: palette(white, mid-light);
    padding: 0;
    text-align: left;
}

/*
 * Full Single Post Article
 * -----------------------------------------------------------------------------
 */

article.full {
    @extend %clearfix;

    @include media(print) {
        padding: 0;
    }

    header {
        @include margin(2, bottom);

        @include media(print) {
            margin-bottom: 0;
        }

        div.meta {
            @extend %clearfix;
            /* For legibility when it is white-on-white. */
            border: 1px solid palette(white, light);
            border-width: 1px 0;
            @include padding(0.75 0);
        }

        div.avatar, div.text {
            float: left;
        }

        div.text {
            float: left;
            text-transform: initial;

            @include media($b-1024) {
                float: none;
                @include margin(1, bottom);
            }
        }

        div.avatar {
            // background-image is set in single.php
            @extend %cover-picture;
            @include square-flex(67px 1);
            @include margin(0.75, right);
        }
    } 

    .article-content {
        @include flex-parent(row);

        .article-body {
            @include flex-child(1);
        }
    }
}

/**
 * Job Archive Index Article 
 * -----------------------------------------------------------------------------
 * The rules here are specific to job archive articles as they have a sligtly
 * different layout. Most of their position and sizing is set below in the
 * archives.
 */

article.jobarchive {
    header, .text, p {
        margin: 0;
    }

    span, h3 {
        font-family: $font-family-arial;
    }

    span {
        font: 12px $font-family-arial;
        text-transform: uppercase;
        @include padding(0.25 0.5);
    }

    span.job-category {
        color: #fff;
        display: inline-block;
        @include margin(0.5, bottom);
        width: 100%;
    }

    span.more {
        background: palette(white, base);
        display: inline-block;
        @include padding(0.25 0.5);
    }

    div.article-body p, .more {
        @include margin(0.5, top);
    }
}

/**
 * Archive Articles
 * ----------------
 * Archive articles have two styles:
 * 
 * 1. Thumbnail is 25% width and 170px height.
 * 2. Lead article thumbnail is 65% width and 325px height. This excludes job
 *    articles.
 */

.article-thumb {
    @extend %cover-picture;

    @include media(smartphone) {
        @include margin(0.5, bottom);
    }

    a {
        display: block;
        height: inherit;
        width: 100%;

        @include media(print) {
            page-break-inside: avoid;
        }
    }
}

#recent-posts article {
    @include flex-parent(row);
    @include padding(1.75, bottom);
    
    @include media(smartphone) {
        @include prefix-value(display, block);
    }

    &:not(:last-child) {
        border-bottom: 1px solid palette(white, x-dark);
        @include margin(1.5, bottom);
    }

    header {
        @include margin(1, bottom);
    }
}

#recent-posts article:nth-child(1):not(.jobarchive) {
    /* Lead article has a reversed layout. This does not apply to a job article.
     * Job articles do not reverse. */
    @include prefix(flex-direction, row-reverse);

    >:first-child {
        @include flex-child(0 1 $archive-width-65);

        @include media(print) {
            @include margin(1, top);
        }
    }

    >:last-child {
        // Explicit, to remove padding set in other block.
        @include padding(0 1 1 0);

        @include media(smartphone) {
            padding: 0;
        }
    }

    .article-thumb {
        height: $archive-article-thumb-height-325;
    }
}

#recent-posts article {
    // Non-first-child articles.
    >:first-child {
        @include flex-child(0 1 $archive-width-25);
    }

    >:last-child {
        @include flex-child(1);
        @include padding(1, left);

        @include media(smartphone) {
            padding: 0;
        }
    } 

    .article-thumb {
        height: $archive-article-thumb-height-170;
    }
}

/**
 * Homepage Lead Article 
 * -----------------------------------------------------------------------------
 * This is the hero article on the site, the first one that you see when the 
 * page loads. 
 */

article.lead {
    border-bottom: 1px solid palette(black, mid-light);

    @include margin(1.5, bottom);
    @include padding(1.5, bottom);

    h1 {
        margin: 0;
    }

    h3 {
        display: inline-block;

        &:after {
            content: ', ';
            @include padding(0.5, right);

            @include media(smartphone) {
                display: none;
            }
        }

        @include media(smartphone) {
            display: block;
        }
    }

    div.article-thumb {
        @include margin(1, bottom);
        @include square-flex(100% 0.5);

        a {
            @include square-flex(100% 0.5);
        }
    }

    div.article-body p {
        margin: 0;
    }
}

/**
 * Related Posts Section
 * -----------------------------------------------------------------------------
 */

div.related-posts {
    @include flex-parent(row, space-between);

    article {
        box-sizing: border-box;
        @include flex-child(0 1 30%);

        @include media($b-768) {
            @include flex-child(0 1 32%);
        }
    }
}
